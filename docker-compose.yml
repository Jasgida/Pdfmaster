version: "3.9"


services:

  frontend:

    build: ./frontend

    container_name: pdfmaster-frontend

    restart: always

    ports:

      - "3000:80" # external 3000 â†’ container 80

    depends_on:

      - backend

    networks:

      - pdfmaster-net


  backend:

    build: ./backend

    container_name: pdfmaster-backend

    restart: always

    environment:

      - FLASK_ENV=production

    expose:

      - "5000"

    networks:

      - pdfmaster-net


  caddy:

    image: caddy:latest

    container_name: pdfmaster-caddy

    restart: always

    ports:

      - "80:80"

      - "443:443"

    volumes:

      - ./Caddyfile:/etc/caddy/Caddyfile

      - caddy_data:/data

      - caddy_config:/config

    depends_on:

      - frontend

      - backend

    networks:

      - pdfmaster-net


networks:

  pdfmaster-net:


volumes:

  caddy_data:

  caddy_config:

